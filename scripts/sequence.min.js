/*
 * Sequence
 * The CSS3 Animation Framework
 *
 * @link https://github.com/IanLunn/sequence
 * @author IanLunn
 * @version 2.0.0
 * @license https://github.com/IanLunn/sequence/blob/master/LICENSE
 * @copyright IanLunn
 */
!function(global){function defineSequence(){"use strict";function extend(a,b){for(var i in b)a[i]=b[i];return a}function convertTimeToMs(time){var convertedTime,fraction;return fraction=time.indexOf("ms")>-1?1:1e3,convertedTime="0s"==time?0:parseFloat(time.replace("s",""))*fraction}function getAllComputedStyles(element){var style,styles={};if(window.getComputedStyle){style=window.getComputedStyle(element,null);for(var numberOfStyles=style.length,i=0;numberOfStyles>i;i++){var prop=style[i],val=style.getPropertyValue(prop);styles[prop]=val}}else if(element.currentStyle){style=element.currentStyle;for(var prop in style)styles[prop]=style[prop]}else if(style=element.style)for(var prop in style)"function"!=typeof style[prop]&&(styles[prop]=style[prop]);return JSON.stringify(styles)}function updateClassList(element,classToAdd,classToRemove){var newClassList,existingClassList=element.className;void 0!==classToAdd&&(newClassList=existingClassList+" "+classToAdd),void 0!==classToRemove&&(newClassList=newClassList.replace(classToRemove,"")),element.className=newClassList}function Sequence(element,numberOfSteps,options){var self={};return self._getAnimationMap={init:function(element,numberOfSteps){return this.clonedSequence=this.createClone(element),this.allClonedElements=this.clonedSequence.getElementsByTagName("*"),this.allElements=element.getElementsByTagName("*"),this.numberOfElements=this.allClonedElements.length,this.originalClasses=this.clonedSequence.className,this.animationMap={},this.steps(numberOfSteps),this.destroyClone(this.clonedSequence),this.animationMap},getNumberOfSteps:function(){},steps:function(numberOfSteps){this.startPhase();for(var stepNo=1;numberOfSteps>=stepNo;stepNo++)this.stepNo="step"+stepNo,this.animationMap[this.stepNo]={},this.phases("in",stepNo),this.phases("out",stepNo)},startPhase:function(){var startElements=[];this.animationMap.start={};for(var elementNo=0;elementNo<this.numberOfElements;elementNo++){var element=this.allClonedElements[elementNo],realElement=this.allElements[elementNo],elementProperties={},allStyles=getAllComputedStyles(element);elementProperties.element=realElement,elementProperties.styles=allStyles,startElements.push(elementProperties)}this.animationMap.start.allElements=startElements},phases:function(direction){var animatedElements=[],allElements=[],maxComputedDuration=0,phase=this.stepNo+"-"+direction;updateClassList(this.clonedSequence,phase),this.animationMap[this.stepNo][direction]={};for(var elementNo=0;elementNo<this.numberOfElements;elementNo++){var element=this.allClonedElements[elementNo],realElement=this.allElements[elementNo],styles=getComputedStyle(element,null)||element.currentStyle,animatedElementProperties={},allElementProperties={},allStyles=getAllComputedStyles(element);if("in"===direction)var prevStyles=this.animationMap.start.allElements[elementNo].styles;else var prevStyles=this.animationMap[this.stepNo]["in"].allElements[elementNo].styles;if(prevStyles!==allStyles){var transitionDuration=convertTimeToMs(styles[Modernizr.prefixed("transitionDuration")]),transitionDelay=convertTimeToMs(styles[Modernizr.prefixed("transitionDelay")]),computedDuration=transitionDuration+transitionDelay;animatedElementProperties.element=realElement,animatedElementProperties.duration=transitionDuration,animatedElementProperties.delay=transitionDelay,animatedElements.push(animatedElementProperties),0!==computedDuration&&computedDuration>maxComputedDuration&&(maxComputedDuration=computedDuration)}allElementProperties.element=realElement,allElementProperties.styles=allStyles,allElements.push(allElementProperties)}updateClassList(this.clonedSequence,"",phase),this.animationMap[this.stepNo][direction].animatedElements=animatedElements,this.animationMap[this.stepNo][direction].allElements=allElements,this.animationMap[this.stepNo][direction].maxDuration=maxComputedDuration},createClone:function(element){var clonedSequence=element.cloneNode(!0);return clonedSequence.style.display="none",clonedSequence.id="sequence",element.parentNode.insertBefore(clonedSequence,element),clonedSequence},destroyClone:function(element){element.parentNode.removeChild(element)}},self._animation={forward:function(nextStepId,direction,self){{var _animation=this,nextStep="step"+nextStepId;"step"+self.currentStepId}_animation.overrideInheritedSpeed(nextStep,"out",!0,self);var phaseToRemove=nextStep+"-out";updateClassList(self.element,"",phaseToRemove),_animation.domDelay(function(){_animation.changePhase("out",self.currentStepId,self,!1),_animation.changePhase("in",nextStepId,self,!1)})},reverse:function(nextStepId,direction,self){var _animation=this,nextStep="step"+nextStepId,currentStep="step"+self.currentStepId;_animation.overrideInheritedSpeed(nextStep,"out",!0,self);var phaseToAdd=nextStep+"-out";updateClassList(self.element,phaseToAdd),_animation.domDelay(function(){_animation.overrideInheritedSpeed(currentStep,"in",!1,self);var phaseToRemove=currentStep+"-in";updateClassList(self.element,"",phaseToRemove),_animation.changePhase("in",nextStepId,self,!1)})},reverseDirectionString:function(direction){var reverseDirection={out:"in","in":"out"};return reverseDirection[direction]},domDelay:function(callback){setTimeout(function(){callback()},domDelayDuration)},changePhase:function(direction,id,self,reset){var _animation=this,step="step"+id,oldPhase=this.reverseDirectionString(direction);reset===!0&&_animation.overrideInheritedSpeed(step,direction,reset,self);var phaseToAdd=step+"-"+direction,phaseToRemove=" step"+id+"-"+oldPhase;updateClassList(self.element,phaseToAdd,phaseToRemove);var phaseDuration=self.animationMap[step][direction].maxDuration;"in"===direction&&(self.animationStarted(self),self.currentStepId=id,setTimeout(function(){self.autoPlay(),self.animationFinished(self)},phaseDuration))},overrideInheritedSpeed:function(step,direction,reset,self){var _animation=this;-1===self.options.autoPlayDirection&&"out"===direction&&(direction="in");for(var stepElements=self.animationMap[step][direction].animatedElements,numberOfStepElements=stepElements.length,transitionDuration="0s",transitionDelay="0s",i=0;numberOfStepElements>i;i++){var stepProperties=stepElements[i];reset!==!0&&(transitionDuration=stepProperties.duration+"ms",transitionDelay=stepProperties.delay+"ms"),stepProperties.element.style.transitionDuration=transitionDuration,stepProperties.element.style.transitionDelay=transitionDelay}_animation.domDelay(function(){for(var i=0;numberOfStepElements>i;i++){var stepProperties=stepElements[i];stepProperties.element.style.transitionDuration="",stepProperties.element.style.transitionDelay=""}})}},self._init=function(){return void 0===numberOfSteps||"number"!=typeof numberOfSteps?(console.error("Sequence.js: numberOfSteps must be specified and as a number"),!1):(self.numberOfSteps=numberOfSteps,self.options=extend(defaults,options),self.animationMap=self._getAnimationMap.init(element,numberOfSteps),void(self.currentStepId=self.options.startingStepId-1))},self.next=function(){var nextStepId=self.currentStepId+1;nextStepId>self.numberOfSteps&&(nextStepId=1),self.goTo(nextStepId,self.options.autoPlayDirection)},self.prev=function(){var prevStepId=self.currentStepId-1;1>prevStepId&&(prevStepId=self.numberOfSteps),self.goTo(prevStepId,self.options.autoPlayDirection)},self.goTo=function(id,direction){1===direction?self._animation.forward(id,direction,self):self._animation.reverse(id,direction,self)},self.autoPlay=function(){self.options.autoPlay===!0&&setTimeout(function(){1===self.options.autoPlayDirection?self.next():self.prev()},self.options.autoPlayThreshold)},self.destroy=function(){},self.animationStarted=function(){},self.animationFinished=function(){},self._init(element,numberOfSteps,options),console.log(self.animationMap),self.element=element,self.currentStepId=self.options.startingStepId,1===self.options.autoPlayDirection?self._animation.changePhase("in",self.currentStepId,self,!1):(self._animation.changePhase("out",self.currentStepId,self,!0),self._animation.domDelay(function(){self._animation.changePhase("in",self.currentStepId,self,!1)})),self}var defaults={autoPlay:!0,autoPlayThreshold:3e3,autoPlayDirection:1,startingStepId:1,startingStepAnimatesIn:!1,cycle:!0,debug:!1},domDelayDuration=50;return Sequence}"function"==typeof define&&define.amd?define(["third-party/hammer.min"],defineSequence):global.sequence=defineSequence()}(this);
//# sourceMappingURL=sequence.min.map